{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# This is Main function.\n",
    "# Extracting streaming data from Twitter, pre-processing, and loading into MySQL\n",
    "import credentials # Import api/access_token keys from credentials.py\n",
    "import pogdb # Import related setting constants from pogdb.py \n",
    "\n",
    "import re\n",
    "import tweepy\n",
    "import mysql.connector\n",
    "import pandas as pd\n",
    "from textblob import TextBlob"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import api/access_token keys from credentials.py\n",
    "import credentials\n",
    "auth  = tweepy.OAuthHandler(credentials.API_KEY, \\\n",
    "                            credentials.API_SECRET_KEY)\n",
    "auth.set_access_token(credentials.ACCESS_TOKEN,  \\\n",
    "                      credentials.ACCESS_TOKEN_SECRET)\n",
    "api = tweepy.API(auth)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "#The fuctions are used to clean the tweets\n",
    "def clean_tweet(self, tweet): \n",
    "    ''' \n",
    "    Use sumple regex statemnents to clean tweet text by removing links and special characters\n",
    "    '''\n",
    "    return ' '.join(re.sub(\"(@[A-Za-z0-9]+)|([^0-9A-Za-z \\t]) \\\n",
    "                                |(\\w+:\\/\\/\\S+)\", \" \", tweet).split()) \n",
    "def deEmojify(text):\n",
    "    '''\n",
    "    Strip all non-ASCII characters to remove emoji characters\n",
    "    '''\n",
    "    if text:\n",
    "        return text.encode('ascii', 'ignore').decode('ascii')\n",
    "    else:\n",
    "        return None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax (<ipython-input-8-9fb180692902>, line 13)",
     "output_type": "error",
     "traceback": [
      "\u001b[0;36m  File \u001b[0;32m\"<ipython-input-8-9fb180692902>\"\u001b[0;36m, line \u001b[0;32m13\u001b[0m\n\u001b[0;31m    SELECT COUNT(*)\u001b[0m\n\u001b[0m               ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax\n"
     ]
    }
   ],
   "source": [
    "#This connnects to the database, checks if a table {\"Tablename\"} exits, if not creates one and closes the connection\n",
    "import os\n",
    "import psycopg2\n",
    "\n",
    "dbconn = psycopg2.connect(\"host=ec2-54-81-37-115.compute-1.amazonaws.com dbname=d58g5m66umb113 user=eigxqdhsrlaffv password=b1495696080d3ad38656b3e2973e25cd8890a1570a7639abdf756cbbd793c8f1\")\n",
    "if dbconn:\n",
    "    print(\"Connected\")\n",
    "    '''\n",
    "    Check if this table exits. If not, then create a new one.\n",
    "    '''\n",
    "    mycursor = mydb.cursor()\n",
    "    mycursor.execute(\n",
    "    SELECT COUNT(*)\n",
    "    FROM information_schema.tables\n",
    "    WHERE table_name = '{0}'\n",
    "    .format(pogdb.TABLE_NAME))\n",
    "    print(\"table exists\")\n",
    "    if mycursor.fetchone()[0] != 1:\n",
    "        mycursor.execute(\"CREATE TABLE {} ({})\".format(pogdb.TABLE_NAME, pogdb.TABLE_ATTRIBUTES))\n",
    "        print(\"Table does not exist so it has been created\")\n",
    "        dbconn.commit()\n",
    "        mycursor.close()\n",
    "else:\n",
    "    print('Not connected')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "#creating a listener to watch for our data\n",
    "#has two functions\n",
    "#on_status it to check for tweets\n",
    "#on_error is to stop tweet checking incase a limit is reached\n",
    "class MyStreamListener(tweepy.StreamListener):\n",
    "    '''\n",
    "    Tweets are known as ‚Äústatus updates‚Äù. So the Status class in tweepy has properties describing the tweet.\n",
    "    https://developer.twitter.com/en/docs/tweets/data-dictionary/overview/tweet-object.html\n",
    "    '''\n",
    "    \n",
    "    def on_status(self, status):\n",
    "        '''\n",
    "        Extract info from tweets\n",
    "        '''\n",
    "        \n",
    "        if status.retweeted:\n",
    "            # Avoid retweeted info, and only original tweets will be received\n",
    "            return True\n",
    "        # Extract attributes from each tweet\n",
    "        id_str = status.id_str\n",
    "        created_at = status.created_at\n",
    "        text = deEmojify(status.text)    # Pre-processing the text  \n",
    "        sentiment = TextBlob(text).sentiment\n",
    "        polarity = sentiment.polarity\n",
    "        subjectivity = sentiment.subjectivity\n",
    "        \n",
    "        user_created_at = status.user.created_at\n",
    "        user_location = deEmojify(status.user.location)\n",
    "        user_description = deEmojify(status.user.description)\n",
    "        user_followers_count =status.user.followers_count\n",
    "        longitude = None\n",
    "        latitude = None\n",
    "        if status.coordinates:\n",
    "            longitude = status.coordinates['coordinates'][0]\n",
    "            latitude = status.coordinates['coordinates'][1]\n",
    "            print(longitude)\n",
    "            print(latitude)\n",
    "        retweet_count = status.retweet_count\n",
    "        favorite_count = status.favorite_count\n",
    "        \n",
    "        print(status.text)\n",
    "        print(\"Long: {}, Lati: {}\".format(longitude, latitude))\n",
    "        \n",
    "        # Store all data in MySQL\n",
    "        if dbconn:\n",
    "            mycursor = dbconn.cursor()\n",
    "            sql = \"INSERT INTO {} (id_str,created_at,text,polarity,\\\n",
    "                subjectivity, user_created_at, user_location,\\\n",
    "                user_description, user_followers_count, longitude,\\\n",
    "                latitude, retweet_count, favorite_count) VALUES \\\n",
    "                (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)\".format(pogdb.TABLE_NAME)\n",
    "            val = (id_str, created_at, text, polarity, subjectivity,\\\n",
    "                 user_created_at, user_location, user_description, user_followers_count, longitude, latitude, retweet_count, favorite_count)\n",
    "            mycursor.execute(sql, val)\n",
    "            dbconn.commit()\n",
    "            mycursor.close()\n",
    "    \n",
    "    \n",
    "    def on_error(self, status_code):\n",
    "        '''\n",
    "        Since Twitter API has rate limits, stop srcraping data as it exceed to the thresold.\n",
    "        '''\n",
    "        if status_code == 420:\n",
    "            # return False to disconnect the stream\n",
    "            return False\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @Nevernyny: Rihanna‚Äôs 'S&amp;M' and Doja Cat 'Say So' are the only remix that went #1 on Billboard Hot 100 in history. https://t.co/GXgjqVys‚Ä¶\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @rihpael: STREAM ANTI by RIHANNA üéà https://t.co/zNP1K0M2nW\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @legendarihhhh: Rihanna was NINETEEN when she released Umbrella. The impact of this song was huge, defined a generation, a timeless clas‚Ä¶\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @bickenricch: Girls Like You says hi\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @ccienty: Rihanna for Vogue Brasil, May. 2014 https://t.co/rV8LlmydAu\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this https://t.co/h8x9ma6cUQ\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @legendarihhhh: Rihanna as songs; a thread https://t.co/2QbO38SMtW\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @ccienty: Rihanna for Vogue Brasil, May. 2014 https://t.co/rV8LlmydAu\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "Science\n",
      "ü§£ü§£ü§£\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "Rihanna v Beyonce*\n",
      "Brent v Bryson \n",
      "Meg Stallion V City girls\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @_melaaninqueen_: i don‚Äôt think we realize how young she is and how you g she was when she gave us all this music lol, she lowkey can re‚Ä¶\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @deepraaajjj: rihanna as indian food/snacks [a thread] https://t.co/9SALprJvNA\n",
      "Long: None, Lati: None\n",
      "RT @Nevernyny: Rihanna‚Äôs 'S&amp;M' and Doja Cat 'Say So' are the only remix that went #1 on Billboard Hot 100 in history. https://t.co/GXgjqVys‚Ä¶\n",
      "Long: None, Lati: None\n",
      "RT @spotify_data: Most streamed female artists on Spotify (5/11 via @spotify_data)\n",
      "\n",
      "#1 @ArianaGrande 14.6m \n",
      "#2 @billieeilish 13.9m\n",
      "#3 @DUAL‚Ä¶\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "@bigboiseokjin Rihanna singing about killing men&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this https://t.co/h8x9ma6cUQ\n",
      "Long: None, Lati: None\n",
      "RT @zeelovee_x: We told you Rihanna or Adele. Jorja Smith? https://t.co/CbjrMfiaiR\n",
      "Long: None, Lati: None\n",
      "RT @legendarihhhh: Rihanna was NINETEEN when she released Umbrella. The impact of this song was huge, defined a generation, a timeless clas‚Ä¶\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @90sHilly: Cardi. Cardi B ladies and gentlemen.\n",
      "Long: None, Lati: None\n",
      "RT @_melaaninqueen_: i don‚Äôt think we realize how young she is and how you g she was when she gave us all this music lol, she lowkey can re‚Ä¶\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "@selankagomez @selenagomez @SelenaFanClub should have been called, selena fangirlinv ober rihanna during fhe years; thread\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "@PopCrave @DUALIPA @BritishGQ @rihanna @kylieminogue that would debut #1\n",
      "\n",
      "https://t.co/Y3qSa63WE8\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this https://t.co/h8x9ma6cUQ\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "do reciters sometimes get too much credit?\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n",
      "RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "Long: None, Lati: None\n"
     ]
    },
    {
     "ename": "ProtocolError",
     "evalue": "('Connection broken: IncompleteRead(0 bytes read)', IncompleteRead(0 bytes read))",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mIncompleteRead\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m/usr/lib/python3.6/http/client.py\u001b[0m in \u001b[0;36m_readinto_chunked\u001b[0;34m(self, b)\u001b[0m\n\u001b[1;32m    592\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmvb\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m<=\u001b[0m \u001b[0mchunk_left\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 593\u001b[0;31m                     \u001b[0mn\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_safe_readinto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmvb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    594\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mchunk_left\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mchunk_left\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/usr/lib/python3.6/http/client.py\u001b[0m in \u001b[0;36m_safe_readinto\u001b[0;34m(self, b)\u001b[0m\n\u001b[1;32m    639\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mn\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 640\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mIncompleteRead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbytes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmvb\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0mtotal_bytes\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    641\u001b[0m             \u001b[0mmvb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmvb\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mn\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mIncompleteRead\u001b[0m: IncompleteRead(0 bytes read, 512 more expected)",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[0;31mIncompleteRead\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/urllib3/response.py\u001b[0m in \u001b[0;36m_error_catcher\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    436\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 437\u001b[0;31m                 \u001b[0;32myield\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    438\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/urllib3/response.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self, amt, decode_content, cache_content)\u001b[0m\n\u001b[1;32m    518\u001b[0m                 \u001b[0mcache_content\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mFalse\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 519\u001b[0;31m                 \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mamt\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mfp_closed\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0;34mb\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    520\u001b[0m                 if (\n",
      "\u001b[0;32m/usr/lib/python3.6/http/client.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self, amt)\u001b[0m\n\u001b[1;32m    458\u001b[0m             \u001b[0mb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mbytearray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mamt\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 459\u001b[0;31m             \u001b[0mn\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreadinto\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    460\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mmemoryview\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0mn\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtobytes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/usr/lib/python3.6/http/client.py\u001b[0m in \u001b[0;36mreadinto\u001b[0;34m(self, b)\u001b[0m\n\u001b[1;32m    492\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mchunked\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 493\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_readinto_chunked\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    494\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/usr/lib/python3.6/http/client.py\u001b[0m in \u001b[0;36m_readinto_chunked\u001b[0;34m(self, b)\u001b[0m\n\u001b[1;32m    603\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mIncompleteRead\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 604\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0mIncompleteRead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbytes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0mtotal_bytes\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    605\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mIncompleteRead\u001b[0m: IncompleteRead(0 bytes read)",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[0;31mProtocolError\u001b[0m                             Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-25-099a5b18892e>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mmyStreamListener\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mMyStreamListener\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mmyStream\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtweepy\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mStream\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mauth\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mapi\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mauth\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlistener\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmyStreamListener\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mmyStream\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfilter\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlanguages\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"en\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrack\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpogdb\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTRACK_WORDS\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0;31m# Close the MySQL connection as it finished\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0;31m# However, this won't be reached as the stream listener won't stop automatically\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/tweepy/streaming.py\u001b[0m in \u001b[0;36mfilter\u001b[0;34m(self, follow, track, is_async, locations, stall_warnings, languages, encoding, filter_level)\u001b[0m\n\u001b[1;32m    472\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbody\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'filter_level'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfilter_level\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mencode\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mencoding\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    473\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msession\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mparams\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m'delimited'\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0;34m'length'\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 474\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_start\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mis_async\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    475\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    476\u001b[0m     def sitestream(self, follow, stall_warnings=False,\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/tweepy/streaming.py\u001b[0m in \u001b[0;36m_start\u001b[0;34m(self, is_async)\u001b[0m\n\u001b[1;32m    387\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_thread\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstart\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    388\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 389\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_run\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    390\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    391\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mon_closed\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresp\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/tweepy/streaming.py\u001b[0m in \u001b[0;36m_run\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    318\u001b[0m             \u001b[0;31m# call a handler first so that the exception can be logged.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    319\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlistener\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_exception\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mexc_info\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 320\u001b[0;31m             \u001b[0msix\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreraise\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0mexc_info\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    321\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    322\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/six.py\u001b[0m in \u001b[0;36mreraise\u001b[0;34m(tp, value, tb)\u001b[0m\n\u001b[1;32m    691\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__traceback__\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mtb\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    692\u001b[0m                 \u001b[0;32mraise\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mwith_traceback\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtb\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 693\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    694\u001b[0m         \u001b[0;32mfinally\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    695\u001b[0m             \u001b[0mvalue\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/tweepy/streaming.py\u001b[0m in \u001b[0;36m_run\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    287\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msnooze_time\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msnooze_time_step\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    288\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlistener\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_connect\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 289\u001b[0;31m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_read_loop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mresp\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    290\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mTimeout\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mssl\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mSSLError\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    291\u001b[0m                 \u001b[0;31m# This is still necessary, as a SSLError can actually be\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/tweepy/streaming.py\u001b[0m in \u001b[0;36m_read_loop\u001b[0;34m(self, resp)\u001b[0m\n\u001b[1;32m    337\u001b[0m             \u001b[0mlength\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    338\u001b[0m             \u001b[0;32mwhile\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mresp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mraw\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclosed\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 339\u001b[0;31m                 \u001b[0mline\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mbuf\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_line\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    340\u001b[0m                 \u001b[0mstripped_line\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mline\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstrip\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mline\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0mline\u001b[0m \u001b[0;31m# line is sometimes None so we need to check here\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    341\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mstripped_line\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/tweepy/streaming.py\u001b[0m in \u001b[0;36mread_line\u001b[0;34m(self, sep)\u001b[0m\n\u001b[1;32m    198\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    199\u001b[0m                 \u001b[0mstart\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_buffer\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 200\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_buffer\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_stream\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_chunk_size\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    201\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0msix\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mb\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m''\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    202\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/urllib3/response.py\u001b[0m in \u001b[0;36mread\u001b[0;34m(self, amt, decode_content, cache_content)\u001b[0m\n\u001b[1;32m    539\u001b[0m                         \u001b[0;31m# raised during streaming, so all calls with incorrect\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    540\u001b[0m                         \u001b[0;31m# Content-Length are caught.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 541\u001b[0;31m                         \u001b[0;32mraise\u001b[0m \u001b[0mIncompleteRead\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_fp_bytes_read\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlength_remaining\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    542\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    543\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mdata\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m/usr/lib/python3.6/contextlib.py\u001b[0m in \u001b[0;36m__exit__\u001b[0;34m(self, type, value, traceback)\u001b[0m\n\u001b[1;32m     97\u001b[0m                 \u001b[0mvalue\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     98\u001b[0m             \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 99\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgen\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mthrow\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtype\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtraceback\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    100\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0mStopIteration\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    101\u001b[0m                 \u001b[0;31m# Suppress StopIteration *unless* it's the same exception that\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/bash/lib/python3.6/site-packages/urllib3/response.py\u001b[0m in \u001b[0;36m_error_catcher\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    453\u001b[0m             \u001b[0;32mexcept\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mHTTPException\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mSocketError\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    454\u001b[0m                 \u001b[0;31m# This includes IncompleteRead.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 455\u001b[0;31m                 \u001b[0;32mraise\u001b[0m \u001b[0mProtocolError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Connection broken: %r\"\u001b[0m \u001b[0;34m%\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0me\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    456\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    457\u001b[0m             \u001b[0;31m# If no exception is thrown, we should avoid cleaning up\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mProtocolError\u001b[0m: ('Connection broken: IncompleteRead(0 bytes read)', IncompleteRead(0 bytes read))"
     ]
    }
   ],
   "source": [
    "#This calls the class myStreamListener thereby witing into the database\n",
    "myStreamListener = MyStreamListener()\n",
    "myStream = tweepy.Stream(auth = api.auth, listener = myStreamListener)\n",
    "myStream.filter(languages=[\"en\"], track = pogdb.TRACK_WORDS)\n",
    "# Close the MySQL connection as it finished\n",
    "# However, this won't be reached as the stream listener won't stop automatically\n",
    "# Press STOP button to finish the process.\n",
    "dbconn.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Selecting rows from mobile table using cursor.fetchall\n",
      "Print each row and it's columns values\n",
      "Id =  1260304585664671747\n",
      "created_at =  2020-05-12 20:23:23\n",
      "text  =  RT @zeelovee_x: We told you Rihanna or Adele. Jorja Smith? https://t.co/CbjrMfiaiR\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304724818923520\n",
      "created_at =  2020-05-12 20:23:56\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304725943164933\n",
      "created_at =  2020-05-12 20:23:56\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304728300322816\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @Nevernyny: Rihannas 'S&amp;M' and Doja Cat 'Say So' are the only remix that went #1 on Billboard Hot 100 in history. https://t.co/GXgjqVys\n",
      "polarity =  0\n",
      "subjectivity =  1 \n",
      "\n",
      "Id =  1260304729562808325\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304729831243777\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @rihpael: STREAM ANTI by RIHANNA  https://t.co/zNP1K0M2nW\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304729965334528\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304730875547650\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304731194482691\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304731311706112\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304731488083968\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304731563589632\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304731655856135\n",
      "created_at =  2020-05-12 20:23:58\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304732226273281\n",
      "created_at =  2020-05-12 20:23:58\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304732612169730\n",
      "created_at =  2020-05-12 20:23:58\n",
      "text  =  RT @legendarihhhh: Rihanna was NINETEEN when she released Umbrella. The impact of this song was huge, defined a generation, a timeless clas\n",
      "polarity =  0\n",
      "subjectivity =  1 \n",
      "\n",
      "Id =  1260304734033936392\n",
      "created_at =  2020-05-12 20:23:58\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304737406255105\n",
      "created_at =  2020-05-12 20:23:59\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304739809603585\n",
      "created_at =  2020-05-12 20:23:59\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304740153389057\n",
      "created_at =  2020-05-12 20:24:00\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304741038505985\n",
      "created_at =  2020-05-12 20:24:00\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304741374066688\n",
      "created_at =  2020-05-12 20:24:00\n",
      "text  =  RT @bickenricch: Girls Like You says hi\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304741990612992\n",
      "created_at =  2020-05-12 20:24:00\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304743009792002\n",
      "created_at =  2020-05-12 20:24:00\n",
      "text  =  RT @ccienty: Rihanna for Vogue Brasil, May. 2014 https://t.co/rV8LlmydAu\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304745174052866\n",
      "created_at =  2020-05-12 20:24:01\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304746545438720\n",
      "created_at =  2020-05-12 20:24:01\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304747363545089\n",
      "created_at =  2020-05-12 20:24:01\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this https://t.co/h8x9ma6cUQ\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304748676173824\n",
      "created_at =  2020-05-12 20:24:02\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304749108264967\n",
      "created_at =  2020-05-12 20:24:02\n",
      "text  =  RT @legendarihhhh: Rihanna as songs; a thread https://t.co/2QbO38SMtW\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304728677912577\n",
      "created_at =  2020-05-12 20:23:57\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304752484782080\n",
      "created_at =  2020-05-12 20:24:02\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304752811933696\n",
      "created_at =  2020-05-12 20:24:03\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304754464493569\n",
      "created_at =  2020-05-12 20:24:03\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304756116983808\n",
      "created_at =  2020-05-12 20:24:03\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304760889987072\n",
      "created_at =  2020-05-12 20:24:04\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304763872296961\n",
      "created_at =  2020-05-12 20:24:05\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304764044226562\n",
      "created_at =  2020-05-12 20:24:05\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304767198380034\n",
      "created_at =  2020-05-12 20:24:06\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304768838164480\n",
      "created_at =  2020-05-12 20:24:06\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304771975647234\n",
      "created_at =  2020-05-12 20:24:07\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304775649918979\n",
      "created_at =  2020-05-12 20:24:08\n",
      "text  =  RT @ccienty: Rihanna for Vogue Brasil, May. 2014 https://t.co/rV8LlmydAu\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304776778088448\n",
      "created_at =  2020-05-12 20:24:08\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304777369587715\n",
      "created_at =  2020-05-12 20:24:08\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304777700872192\n",
      "created_at =  2020-05-12 20:24:08\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304778749521925\n",
      "created_at =  2020-05-12 20:24:09\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304780058116100\n",
      "created_at =  2020-05-12 20:24:09\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304780204933122\n",
      "created_at =  2020-05-12 20:24:09\n",
      "text  =  Science\n",
      "\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304781295456258\n",
      "created_at =  2020-05-12 20:24:09\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304782058758146\n",
      "created_at =  2020-05-12 20:24:10\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304784562827279\n",
      "created_at =  2020-05-12 20:24:10\n",
      "text  =  Rihanna v Beyonce*\n",
      "Brent v Bryson \n",
      "Meg Stallion V City girls\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304786009862147\n",
      "created_at =  2020-05-12 20:24:10\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304789163905025\n",
      "created_at =  2020-05-12 20:24:11\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304790808137739\n",
      "created_at =  2020-05-12 20:24:12\n",
      "text  =  RT @_melaaninqueen_: i dont think we realize how young she is and how you g she was when she gave us all this music lol, she lowkey can re\n",
      "polarity =  0\n",
      "subjectivity =  1 \n",
      "\n",
      "Id =  1260304791273603073\n",
      "created_at =  2020-05-12 20:24:12\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304794809274368\n",
      "created_at =  2020-05-12 20:24:13\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304797359460352\n",
      "created_at =  2020-05-12 20:24:13\n",
      "text  =  RT @deepraaajjj: rihanna as indian food/snacks [a thread] https://t.co/9SALprJvNA\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304797883826177\n",
      "created_at =  2020-05-12 20:24:13\n",
      "text  =  RT @Nevernyny: Rihannas 'S&amp;M' and Doja Cat 'Say So' are the only remix that went #1 on Billboard Hot 100 in history. https://t.co/GXgjqVys\n",
      "polarity =  0\n",
      "subjectivity =  1 \n",
      "\n",
      "Id =  1260304798915706885\n",
      "created_at =  2020-05-12 20:24:14\n",
      "text  =  RT @spotify_data: Most streamed female artists on Spotify (5/11 via @spotify_data)\n",
      "\n",
      "#1 @ArianaGrande 14.6m \n",
      "#2 @billieeilish 13.9m\n",
      "#3 @DUAL\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304799305814022\n",
      "created_at =  2020-05-12 20:24:14\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304799884607490\n",
      "created_at =  2020-05-12 20:24:14\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304800832540673\n",
      "created_at =  2020-05-12 20:24:14\n",
      "text  =  @bigboiseokjin Rihanna singing about killing men&gt;&gt;&gt;&gt;&gt;&gt;&gt;\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304800828338181\n",
      "created_at =  2020-05-12 20:24:14\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304801096753152\n",
      "created_at =  2020-05-12 20:24:14\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this https://t.co/h8x9ma6cUQ\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304801142919170\n",
      "created_at =  2020-05-12 20:24:14\n",
      "text  =  RT @zeelovee_x: We told you Rihanna or Adele. Jorja Smith? https://t.co/CbjrMfiaiR\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304805186220032\n",
      "created_at =  2020-05-12 20:24:15\n",
      "text  =  RT @legendarihhhh: Rihanna was NINETEEN when she released Umbrella. The impact of this song was huge, defined a generation, a timeless clas\n",
      "polarity =  0\n",
      "subjectivity =  1 \n",
      "\n",
      "Id =  1260304805219627008\n",
      "created_at =  2020-05-12 20:24:15\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304806276718592\n",
      "created_at =  2020-05-12 20:24:15\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304807279108096\n",
      "created_at =  2020-05-12 20:24:16\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304807782383616\n",
      "created_at =  2020-05-12 20:24:16\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304811729264640\n",
      "created_at =  2020-05-12 20:24:17\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304813859971072\n",
      "created_at =  2020-05-12 20:24:17\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304814010798080\n",
      "created_at =  2020-05-12 20:24:17\n",
      "text  =  RT @90sHilly: Cardi. Cardi B ladies and gentlemen.\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304814686289924\n",
      "created_at =  2020-05-12 20:24:17\n",
      "text  =  RT @_melaaninqueen_: i dont think we realize how young she is and how you g she was when she gave us all this music lol, she lowkey can re\n",
      "polarity =  0\n",
      "subjectivity =  1 \n",
      "\n",
      "Id =  1260304816053641216\n",
      "created_at =  2020-05-12 20:24:18\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304819484573696\n",
      "created_at =  2020-05-12 20:24:18\n",
      "text  =  @selankagomez @selenagomez @SelenaFanClub should have been called, selena fangirlinv ober rihanna during fhe years; thread\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304820038258688\n",
      "created_at =  2020-05-12 20:24:19\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304821351038977\n",
      "created_at =  2020-05-12 20:24:19\n",
      "text  =  @PopCrave @DUALIPA @BritishGQ @rihanna @kylieminogue that would debut #1\n",
      "\n",
      "https://t.co/Y3qSa63WE8\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304822672199682\n",
      "created_at =  2020-05-12 20:24:19\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304823292960771\n",
      "created_at =  2020-05-12 20:24:19\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this https://t.co/h8x9ma6cUQ\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304823624310784\n",
      "created_at =  2020-05-12 20:24:19\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304824316440586\n",
      "created_at =  2020-05-12 20:24:20\n",
      "text  =  do reciters sometimes get too much credit?\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304826363150340\n",
      "created_at =  2020-05-12 20:24:20\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304827655106560\n",
      "created_at =  2020-05-12 20:24:20\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304829076983808\n",
      "created_at =  2020-05-12 20:24:21\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304829026574337\n",
      "created_at =  2020-05-12 20:24:21\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304829777235968\n",
      "created_at =  2020-05-12 20:24:21\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304835666206720\n",
      "created_at =  2020-05-12 20:24:22\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304837046124546\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304837406851078\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304837826301952\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304838333739010\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304838396653571\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304838786715648\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304838988087296\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304839390699522\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304840384708608\n",
      "created_at =  2020-05-12 20:24:23\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "Id =  1260304841231998977\n",
      "created_at =  2020-05-12 20:24:24\n",
      "text  =  RT @LilNasX: i did not make 27 remixes to the same song to be disrespected like this\n",
      "polarity =  0\n",
      "subjectivity =  0 \n",
      "\n",
      "PostgreSQL connection is closed\n"
     ]
    },
    {
     "ename": "AttributeError",
     "evalue": "'NoneType' object has no attribute 'close'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-5-4f773e78f052>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     33\u001b[0m         \u001b[0mcursor\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     34\u001b[0m         \u001b[0mconnection\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 35\u001b[0;31m         \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"PostgreSQL connection is closed\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;31mAttributeError\u001b[0m: 'NoneType' object has no attribute 'close'"
     ]
    }
   ],
   "source": [
    "#This is used to read data from the database\n",
    "import psycopg2\n",
    "try:\n",
    "    connection = psycopg2.connect(user=\"eigxqdhsrlaffv\",\n",
    "                                  password=\"b1495696080d3ad38656b3e2973e25cd8890a1570a7639abdf756cbbd793c8f1\",\n",
    "                                  host=\"ec2-54-81-37-115.compute-1.amazonaws.com\",\n",
    "                                  database=\"d58g5m66umb113\")\n",
    "    cursor = connection.cursor()\n",
    "    postgreSQL_select_Query = \"select * from rihannasec\"\n",
    "\n",
    "    cursor.execute(postgreSQL_select_Query)\n",
    "    print(\"Selecting rows from mobile table using cursor.fetchall\")\n",
    "    tweet_records = cursor.fetchall() \n",
    "   \n",
    "    print(\"Print each row and it's columns values\")\n",
    "    for row in tweet_records:\n",
    "        print(\"Id = \", row[0], )\n",
    "        print(\"created_at = \", row[1], )\n",
    "        print(\"text  = \", row[2], )\n",
    "        print(\"polarity = \", row[3], )\n",
    "        print(\"subjectivity = \", row[4], \"\\n\")\n",
    "\n",
    "except (Exception, psycopg2.Error) as error :\n",
    "    print (\"Error while fetching data from PostgreSQL\", error)\n",
    "\n",
    "finally:\n",
    "    #closing database connection.\n",
    "    if connection:\n",
    "        cursor.close()\n",
    "        connection.close()\n",
    "        print(\"PostgreSQL connection is closed\").close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
